/*

  # ----- Script info:
  - Author: Michael Mammoliti
  - Name: calculator.js
  - Version: 0.2
  - js dipendencies: jQuery
  - Release date: 17 november 2015

  # ----- Contact info
  - GitHub: https://github.com/MichaelMammoliti/calculator.js
  - Mail: mammoliti.michael@gmail.com

  # ----- License Info
  - Released under the MIT license.

*/

function Plugin(e,t){this.settings=$.extend({},t,defaults),this.$context=$(e),this.$display=this.$context.find("#display"),this.$keys=this.$context.find("#keys"),this.$memoryKey=this.$keys.find("#memorykey"),this.$resetKey=this.$keys.find("#resetkey"),this.$memoryKey=this.$keys.find("#memorykey"),this.firstNum=void 0,this.secondNum=void 0,this.floatNum=!1,this.currentOperator=void 0,this.writingState=void 0,this.prevKey=void 0,this.keyType=void 0,this.keyValue=void 0,this.memory=void 0,this.init()}var pluginName="calculator",defaults={};Plugin.prototype={init:function(){var e=this;this.events(),this.utilities.debug.call(e)},events:function(){var e=this;e.$keys.on("click","button",function(){var t=$(this);switch(e.keyType=t.data("type"),e.keyValue=t.text(),e.$resetKey.text("C"),e.keyType){case"number":e.handle.num.call(e);break;case"operator":e.handle.operator.call(e);break;case"function":e.handle.func.call(e)}"AC"!==e.keyValue&&(e.writingState=e.keyType,e.prevKey=e.keyValue,e.utilities.debug.call(e))})},calculate:function(e,t){var i,r=this;switch(e=parseFloat(e),t=parseFloat(t),r.currentOperator){case"+":i=r.operations.addition(e,t);break;case"-":i=r.operations.subtraction(e,t);break;case"*":i=r.operations.multiplication(e,t);break;case"/":i=r.operations.division(e,t)}return i},render:function(e){var t=this;return t.$display.text(e),e},handle:{num:function(){var e=this,t=e.$display.text();if("operator"===e.writingState&&(t="0"),"="===e.prevKey&&(t="0",e.firstNum=void 0,e.secondNum=void 0),"0"===t&&(t=""),"."===e.keyValue){if(""==t&&(t="0"),e.floatNum)return;e.floatNum=!0}e.render(t+e.keyValue)},operator:function(){var e,t=this,i=parseFloat(t.$display.text());return t.floatNum=!1,t.currentOperator||(t.currentOperator=t.keyValue),"operator"===t.writingState?void(t.writingState=t.keyValue):"="===t.prevKey?(t.currentOperator=t.keyValue,t.secondNum=void 0,void(t.firstNum=i)):(void 0===t.firstNum?t.firstNum=i:void 0===t.secondNum&&(t.secondNum=i,e=t.calculate(t.firstNum,t.secondNum),t.render(e),t.firstNum=e,t.secondNum=void 0),void(t.currentOperator=t.keyValue))},func:function(){var e=this;switch(e.keyValue){case"=":e.functions.getResult.call(e);break;case"M+":e.functions.memorize.call(e);break;case"M-":e.functions.unmemorize.call(e);break;case"%":e.functions.percentage.call(e);break;case"+/-":e.functions.convertPolarity.call(e);break;case"AC":e.functions.resetCalc.call(e);break;case"C":e.functions.clearDisplay.call(e)}}},operations:{addition:function(e,t){return e+t},subtraction:function(e,t){return e-t},multiplication:function(e,t){return e*t},division:function(e,t){return e/t}},functions:{resetCalc:function(){var e=this;e.$resetKey.text("AC"),e.$display.text("0"),e.firstNum=void 0,e.secondNum=void 0,e.keyValue=void 0,e.keyType=void 0,e.currentOperator=void 0,e.floatNum=!1,e.memory=void 0},clearDisplay:function(){var e=this;e.$resetKey.text("AC"),e.$display.text("0")},memorize:function(){var e=this,t=e.$display.text();return e.memory=parseFloat(t),e.$display.text("0"),e.$memoryKey.text("M-"),t},unmemorize:function(){var e=this,t=e.memory;return e.$display.text(t),e.memory=void 0,e.$memoryKey.text("M+"),t},convertPolarity:function(){var e=this,t=e.$display.text();return e.$display.text(-1*t),-1*t},percentage:function(){var e=this,t=e.firstNum/100*e.$display.text();return e.$display.text(t),t},getResult:function(){var e,t=this,i=parseFloat(t.$display.text());return void 0===t.secondNum&&(t.secondNum=i),e=t.calculate(t.firstNum,t.secondNum),t.render(e),t.firstNum=e,e}},utilities:{debug:function(){var e,t=this;if(t.settings.debug)return e=t,console.log(e),e}}},$.fn[pluginName]=function(e){$(this).each(function(){return new Plugin(this,e)})},$("#calculator").calculator();